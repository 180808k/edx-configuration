# Ubuntu upstart file at /etc/init/mongodb.conf

pre-start script
    mkdir -p {{ MONGO_DIR }}
    mkdir -p {{ MONGO_LOG_DIR }}

    touch {{ MONGO_LOG_DIR }}/mongodb.log

    chown mongodb:nogroup -R {{ MONGO_DIR }}
    chown mongodb:nogroup -R {{ MONGO_LOG_DIR }}
end script

start on runlevel [2345]
stop on runlevel [06]

script
    ENABLE_MONGODB="yes"
    if [ -f /etc/default/mongodb ]; then . /etc/default/mongodb; fi
    if [ "x$ENABLE_MONGODB" = "xyes" ]; then exec start-stop-daemon --start --quiet --chuid mongodb --exec  /usr/bin/mongod -- --config /etc/mongodb.conf; fi
end script
